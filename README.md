# Composite
Composite presale smart contract

## Использование смарт-контракта CompositPresale
### (на примере работы через Mist)

1.	Для работы и приема средств в основном блокчейне контракт нужно выгрузить в основой Ethereum-блокчейн

2.	В контракте определены несколько вспомогательных классов-контрактов. Вам нужно запустить CompositCoinPresale

3.	В качестве параметра нужно передать значение rate (курс). 
В связи с тем, что смарт-контракты не поддерживают работы с дробными числами rate должно быть целым числом от 1 до 9999. Rate это "курс" токена CMC. Фактически он означает "сколько эфира нужно заплатить за 10000 CMC". 
Рассчитать его можно по следующей формуле:
rate = 10000 * (курс CMC в USD) / (курс ETH в USD). 
Например, если сегодня курс эфира 450 долларов, а мы хотим продавать CMC по 0,5 доллара, то rate = 10000 * 0,5 /450 = 11,11... Т.е. примерно 11. 


4.	После загрузки контракта в сеть у него появится адрес https://gyazo.com/d8f6bfa45a1807e1290502ed30936991
 Именно на этот адрес инвесторам предстоит отправлять вам эфир. 

5.	После отправки контракта в сеть в его параметрах появится адрес токена CMC https://gyazo.com/016385fabd63097be8bc56cda531b0bc
Все кто хочет, чтобы информация об этом токене (например, баланс на счету) отображался в Mist должны, добавить этот адрес в разделе 

Contracts -> Custom Tokens -> Watch Token https://gyazo.com/444b4bb85624297d73852707d3a27bf1
 Интерфейс добавления будет выглядеть так: https://gyazo.com/30898b3bf45703018d29200172b6ecd1

6.	 В интерфейсе контракта будут доступны его текущие параметры

•	Rate - курс для расчета стоимости токена
•	EndTime - дата и время завершения crowdSale. Пока она не завершена это значение равно нулю
•	WeiRaised - сколько всего эфира отправили инвесторы на контракт. Сумма отображается в Wei. Wei это частичка эфира, такая что один эфир это десять в восемнадцатой степени вей. Нулей непривычно много, но это специфика смарт-контрактов, которые не работают с дробными числами. Вне параметров контракта вы и ваши инвесторы будут видеть привычные десятичные значения с запятой. 
•	TokensMinted - сколько всего выпущено токенов. Количество тоже умножено на 10 в восемнадцатой степени
•	StartTime - время начала продажи токенов. Совпадает со временем загрузки контракта в сеть
•	isFinished - переменная отображающая была ли уже завершена продажа токенов
•	MinimumSupply - минимальное количество токенов, которое может быть продано за одну транзакцию
•	HardCapTokens - сколько всего может быть продано токенов. Это 1 000 000 умноженное на десять в восемнадцатой степени
•	Token - адрес токенов CMC необходимый для отслеживания балансов

7.	Также в интерфейсе контракта можно будет вызвать ряд функций https://gyazo.com/43f54ae17162100054b169119ad98b32

<li>	SetRate - Установить rate
<li>	BuyTokens - купить токены. При отправке эфира на адрес контракта вызывается автоматически
<li>	FinishPresale - завершить продажу токенов
<li>	TransferOwnership - изначально Владельцем контракта становится тот, кто загрузил контракт в сеть. Только с этого же кошелька возможен вызов функций SetRate, FinishCrowdSale, TransferOwnership. Но Владелец может передать свои права на другой адрес при помощи этой функции. 

8.	Под интерфейсом контракта можно отслеживать события генерируемые контрактом. Для этого нужно поставить галочку в поле Watch contract events https://gyazo.com/e1488a7b77519b001cb31d5e30656b66
В событиях будет выводиться кто и когда совершил перевод на адрес контракта, сумма эфира (в wei), сколько он получил токенов (тоже надо поделить на десять в восемнадцатой) и сколько всего токенов было выпущено к этому моменту. 
Для удобства отслеживания продаж были добавлены значения ether_value, tokens_amount и tokensSoldAmount, которые отображают описанные выше значения поделенные на десять в восемнадцатой степени. Эти значения неточные! Чтобы удовлетворить ограничениям смарт-контрактов они были округлены до целого числа вниз. 
На скриншоте вы можете видеть, что перевод в 0,4 эфира после отображения выводится как 0. Чтобы определить точное значение перевода следует брать данные из поля value. 

9.	Все поступающие на счет контракта средства автоматически переправляются на кошелек Владельца контракта.


## Команда разработчиков желает вам удачи в продажах и  вашем бизнесе!

